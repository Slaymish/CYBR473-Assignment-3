#pragma once
#include <string>
#include <windows.h> // Required for asm("nop") or alternative

std::string deobfuscate(const char* obf_str);
std::string generate_client_id();
std::string get_system_info();
int get_random_sleep_interval(int base_seconds);

inline void add_junk_instruction() {
    // Add a no-operation instruction to obfuscate code flow
    // counter measure against flow oriented disassembly

    //Disassembly             Execution
    //* mov ax, 05EBh         mov ax, 05EBh
    //* xor eax, eax          xor eax, eax
    //* jz -7                 jz -7
    //* Call                  jmp 5


    __asm__ __volatile__(".byte 0x66, 0xB8, 0xEB, 0x05, 0x31, 0xC0, 0x74, 0xF9, 0xE8");
}

inline void add_impossible_disassembly() {
    // Add an impossible disassembly instruction to obfuscate code flow

    __asm__ __volatile__(".byte 0xEB, 0xFF, 0xC0, 0x48");
}