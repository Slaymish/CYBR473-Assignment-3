Keylogging [10%]

Your malware must implement a keylogger. Your keylogger should map non-printable keys (e.g., ENTER, TAB, etc.) to readable tokens such as [ENTER], [TAB]. You may use standard libraries or key mapping tables for this.

Exfiltration [5%]

Your malware should periodically upload the keylog file to the command-and-control server and delete the (locally saved) keylog file. Ensure reliable exfiltration: your malware must confirm that data has been successfully uploaded before deleting local copies. Implement retries on failure (e.g., retry up to 3 times).

Data encoding [5%]

Your malware should implement encoding and decoding strategies to hide data in-memory, on-disk, and when sent over the network. So the data here includes strings within the malware, as well as the communicated data, e.g. data being exfiltrated, the received commands, etc. If you want me to be more specific: Apply encoding at the following stages:

    When storing keylogs on disk
    Before sending data to the C2 server
    For hard-coded string constants (e.g., URLs, keys) 

You should implement a variation of the NULL XOR encryption from the book and lectures, with this change: each time the XORing is done, the key should go through a bitwise circular shift to right by one bit. The encryption key is one byte long and pre-assigned (hard-coded). Choose the key as you wish.

Beaconing [5%]

Implement regular beacons (e.g., every 30 seconds) to indicate active status (the malware is alive, functioning and ready for instructions.). Each beacon should include the unique malware ID and a timestamp. For the Core, it is sufficient to beacon at a regular time periods. When the command-and-control server lists infected hosts, it should use this information to indicate whether each victim is believed to be active or inactive.

Package as a binary (executable) file and build a social engineering exploit [5%+5%]

You must package your malware as a standalone binary (compiled for a 32-bit Windows OS).

You should prepare a "phishing" email aimed at me (arman) that is designed to have the victim (me!) run it (which will then install itself). Don't send that email to me though -- this is just a text file, part of your submission!

Completion [50% overall]

This should be attempted only when you have finished all the Core parts. The intention here is to apply techniques to make your malware stealthier and evade detection. The defender's aim is to locate the malware infection and develop countermeasures against it. In particular:

    The defender will collect packet traces from the network and use the traffic analysis to identify the infected hosts via their data exfiltration and beaconing.
    The malware analyst will eventually find the hard-coded key and will be able to decipher the communications of malware with the C2.
    From the collected packet traces, identify artifacts that might suggest that it is not an benign web traffic but malware communicating with command-and-control server (so it can develop network signatures to block its traffic at the network gateway).
    Identify the location of the command-and-control server so a takedown request can be actioned.
    Spoof the C&C server itself to send the shutdown command to all hosts on the network to try and deactivate the malware.
    Reboot the client machines so that the malware will be forced to shut down.
    Look for evidence of keylog data files on client machines.
    Say the defender has managed to identify the machine that is infected and has a copy of your malware. You know that they are likely to use IDA-pro for disassembly to analyse your malware.
    They may also run your malware executable in a debugger for analysis.
    They will analyse your malware in a virtual machine such as VirtualBox.
    The target's machine has a signature-based antivirus protection.
    The target's machine may have a sophisticated antivirus software like Microsoft defender. 

Implement counter-mechanisms to resist against as many of the above defense actions as you can (to make the job of the defenders more difficult). Note that for some of these tasks, although you can rely on the material from the book for ideas, the actual implementation may need some experimentation and further research. We are interested in your depth of exploration and your failures as well as your successes. 
